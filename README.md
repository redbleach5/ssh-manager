# SSH Manager

**Массовое управление серверами через SSH**

Современный веб-интерфейс для асинхронного выполнения команд на множестве серверов. Построен на Next.js 15 с использованием React, TypeScript и Tailwind CSS.

![SSH Manager](https://img.shields.io/badge/Next.js-15-black?style=flat-square&logo=next.js)
![TypeScript](https://img.shields.io/badge/TypeScript-5.x-blue?style=flat-square&logo=typescript)
![License](https://img.shields.io/badge/License-MIT-green?style=flat-square)

---

## 📋 Содержание

- [Возможности](#-возможности)
- [Требования](#-требования)
- [Установка](#-установка)
- [Использование](#-использование)
- [Форматы файлов хостов](#-форматы-файлов-хостов)
- [Настройки](#-настройки)
- [API](#-api)
- [Безопасность](#-безопасность)
- [Скриншоты](#-скриншоты)

---

## ✨ Возможности

### Основные функции

| Функция | Описание |
|---------|----------|
| 🔌 **SSH подключения** | Асинхронное подключение к множеству серверов (до 50 параллельно) |
| ⌨️ **Массовое выполнение** | Выполнение команд на всех выбранных хостах одновременно |
| 🔐 **Аутентификация** | Поддержка паролей и SSH-ключей (OpenSSH, PuTTY PPK) |
| 📁 **Импорт хостов** | Загрузка файлов TXT, CSV, XLSX, XLS с валидацией IP |
| 📊 **Real-time статусы** | Прогресс-бары и индикаторы статуса в реальном времени |
| 🔄 **Режим добивания** | Автоматические повторные попытки для недоступных хостов |
| 💾 **Экспорт результатов** | Выгрузка в CSV, JSON, TXT, XLSX |
| 📜 **История команд** | Сохранение истории выполненных команд |
| ⚡ **Пресеты** | Быстрый доступ к часто используемым командам |

### Интерфейс

- 🇷🇺 Полностью русскоязычный интерфейс
- 🎨 Современный дизайн на shadcn/ui
- 📱 Адаптивный интерфейс с изменяемыми панелями
- 🌙 Поддержка тёмной/светлой темы
- 🔍 Фильтрация и поиск по хостам

---

## 💻 Требования

- **Node.js** 18+ или **Bun**
- **npm**, **yarn**, **pnpm** или **bun**

### Поддерживаемые ОС

- ✅ Windows 10/11
- ✅ Linux (Ubuntu, Debian, CentOS, Fedora и др.)
- ✅ macOS

---

## 🚀 Установка

### Клонирование

```bash
git clone https://github.com/redbleach5/ssh-manager.git
cd ssh-manager
```

### Установка зависимостей

С использованием **bun** (рекомендуется):
```bash
bun install
```

С использованием **npm**:
```bash
npm install
```

### Запуск

```bash
# Bun
bun run dev

# npm
npm run dev
```

Приложение будет доступно по адресу: **http://localhost:3000**

---

## 📖 Использование

### 1. Добавление хостов

#### Вручную
1. Нажмите кнопку **"Добавить хост"**
2. Заполните данные:
   - IP адрес (обязательно)
   - Порт (по умолчанию 22)
   - Имя пользователя (по умолчанию root)
   - Тип аутентификации (пароль или SSH ключ)
3. Нажмите **"Добавить"**

#### Из файла
1. Перейдите на вкладку **"Загрузка"**
2. Перетащите файл или нажмите для выбора
3. Поддерживаемые форматы: `.txt`, `.csv`, `.xlsx`, `.xls`
4. Проверьте превью и подтвердите добавление

### 2. Выбор хостов

- Кликните на чекбокс напротив хоста для выбора
- Используйте чекбокс в заголовке таблицы для выбора всех
- Фильтруйте по статусу или используйте поиск

### 3. Выполнение команд

1. Перейдите на вкладку **"Выполнение"**
2. Введите команду или выберите пресет
3. Настройте параметры (опционально)
4. Нажмите **"Выполнить"**
5. Наблюдайте за прогрессом в реальном времени

### 4. Просмотр результатов

1. Перейдите на вкладку **"Результаты"**
2. Фильтруйте по статусу (успех/ошибка)
3. Кликните на результат для детального просмотра
4. Экспортируйте при необходимости

---

## 📁 Форматы файлов хостов

### TXT

```
# Комментарии начинаются с #
192.168.1.1
192.168.1.2 admin password123
192.168.1.3:2222 root secretpass
192.168.1.4, 192.168.1.5, 192.168.1.6
```

### CSV

```csv
ip,port,username,password,name
192.168.1.1,22,admin,password1,Web Server
192.168.1.2,22,root,password2,DB Server
```

### XLSX/XLS

Таблица с колонками:
| IP | Port | Username | Password | Name |
|----|------|----------|----------|------|
| 192.168.1.1 | 22 | admin | password | Server 1 |

**Поддерживаемые заголовки:**
- IP: `ip`, `host`, `адрес`
- Порт: `port`, `порт`
- Пользователь: `user`, `username`, `login`, `пользователь`
- Пароль: `pass`, `password`, `пароль`
- Название: `name`, `hostname`, `имя`

---

## ⚙️ Настройки

### Параметры выполнения

| Параметр | По умолчанию | Описание |
|----------|--------------|----------|
| Таймаут подключения | 30000 мс | Время ожидания подключения |
| Таймаут команды | 60000 мс | Время ожидания выполнения команды |
| Максимум параллельных | 30 | Количество одновременных подключений |

### Режим добивания

| Параметр | По умолчанию | Описание |
|----------|--------------|----------|
| Включить повторы | Да | Автоматические повторные попытки |
| Количество попыток | 3 | Максимальное число повторов |
| Задержка | 5000 мс | Пауза между попытками |
| Бесконечные повторы | Нет | Продолжать до успеха |

### Настройки приложения

| Параметр | Описание |
|----------|----------|
| Сохранять хосты | Сохранять список между сессиями |
| Шифровать ключи | Хранить SSH ключи в зашифрованном виде |
| История команд | Максимум записей в истории |

---

## 🔌 API

### POST /api/stream

Выполнение команды с Server-Sent Events.

**Запрос:**
```json
{
  "hosts": [
    {
      "id": "uuid",
      "ip": "192.168.1.1",
      "port": 22,
      "username": "root",
      "authType": "password",
      "password": "encrypted"
    }
  ],
  "command": "uptime",
  "settings": {
    "connectionTimeout": 30000,
    "commandTimeout": 60000,
    "maxConcurrent": 30,
    "retryEnabled": true,
    "retryAttempts": 3,
    "retryDelay": 5000,
    "retryInfinite": false
  }
}
```

**События SSE:**
- `start` — начало выполнения
- `status` — изменение статуса хоста
- `result` — результат выполнения
- `error` — ошибка на хосте
- `complete` — завершение выполнения

### POST /api/hosts

Парсинг файла с хостами.

### POST /api/export

Экспорт результатов.

---

## 🔒 Безопасность

### Хранение данных

- **Пароли и SSH ключи** шифруются перед сохранением
- **localStorage** используется для персистентности данных
- Данные **не передаются** на внешние серверы

### Рекомендации

1. **Не храните** продакшн-ключи в браузере длительное время
2. Используйте **отдельные ключи** для SSH Manager
3. **Ограничьте права** SSH-ключей минимально необходимыми
4. Используйте **VPN** при работе с серверами

### SSH ключи

Поддерживаются форматы:
- **OpenSSH** (рекомендуется)
- **PuTTY PPK**

Для конвертации PPK в OpenSSH:
```bash
puttygen key.ppk -O private-openssh -o key.openssh
```

---

## 🖼️ Скриншоты

### Главный экран

```
┌─────────────────────────────────────────────────────────────────┐
│  🖥️ SSH Manager          Хостов: 5  Выбрано: 3     ⚙️          │
├─────────────────────────────────────────────────────────────────┤
│                         │                                       │
│  ХОСТЫ                  │  ВЫПОЛНЕНИЕ │ ЗАГРУЗКА │ РЕЗУЛЬТАТЫ  │
│  ─────────────────      │                                       │
│  [+] Добавить хост      │  Команда:                             │
│                         │  ┌─────────────────────────────────┐  │
│  ☐ 192.168.1.1:22      │  │ uptime                          │  │
│  ☑ 192.168.1.2:22      │  └─────────────────────────────────┘  │
│  ☑ 192.168.1.3:22      │                                       │
│  ☑ 192.168.1.4:22      │  Быстрые: [uptime] [df -h] [top]     │
│  ☐ 192.168.1.5:22      │                                       │
│                         │  ▶ Выполнить   Выбрано: 3            │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🛠️ Разработка

### Структура проекта

```
ssh-manager/
├── src/
│   ├── app/
│   │   ├── page.tsx          # Главная страница
│   │   ├── layout.tsx        # Layout
│   │   ├── globals.css       # Глобальные стили
│   │   └── api/
│   │       ├── stream/       # SSE API выполнения
│   │       ├── hosts/        # API парсинга файлов
│   │       └── export/       # API экспорта
│   ├── components/
│   │   ├── ui/               # shadcn/ui компоненты
│   │   └── ssh-manager/      # Компоненты приложения
│   ├── lib/
│   │   ├── ssh/              # SSH логика
│   │   ├── parsers/          # Парсеры файлов
│   │   └── crypto-utils.ts   # Шифрование
│   ├── store/                # Zustand store
│   ├── types/                # TypeScript типы
│   └── hooks/                # React хуки
├── package.json
└── README.md
```

### Скрипты

```bash
bun run dev      # Запуск в режиме разработки
bun run build    # Сборка для продакшн
bun run lint     # Проверка кода
```

### Технологии

- **Next.js 15** — React фреймворк
- **React 19** — UI библиотека
- **TypeScript** — типизация
- **Tailwind CSS** — стили
- **shadcn/ui** — компоненты
- **Zustand** — state management
- **ssh2** — SSH клиент (Node.js)
- **xlsx** — работа с Excel

---

## 📝 Лицензия

MIT License

---

## 👤 Автор

SSH Manager Team

---

## 🤝 Вклад в проект

Pull requests приветствуются! Для крупных изменений сначала откройте issue для обсуждения.

---

## 📞 Поддержка

Если у вас возникли вопросы или проблемы, создайте [Issue](https://github.com/redbleach5/ssh-manager/issues) в репозитории.
